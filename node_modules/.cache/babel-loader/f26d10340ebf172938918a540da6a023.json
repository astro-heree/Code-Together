{"ast":null,"code":"import _regeneratorRuntime from\"/Users/amankumar/Code-Together/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/amankumar/Code-Together/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import React,{useEffect}from'react';import codemirror from'codemirror';import'codemirror/mode/javascript/javascript';import'codemirror/theme/dracula.css';import'codemirror/addon/edit/closetag';import'codemirror/addon/edit/closebrackets';import'codemirror/lib/codemirror.css';import{useRef}from'react';import ACTIONS from'../Actions';import{jsx as _jsx}from\"react/jsx-runtime\";var Editor=function Editor(_ref){var socketRef=_ref.socketRef,roomId=_ref.roomId,onCodeChange=_ref.onCodeChange;var editorRef=useRef(null);useEffect(function(){var init=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:editorRef.current=codemirror.fromTextArea(document.getElementById(\"realtimeEditor\"),{mode:{name:\"javascript\",json:true},theme:\"dracula\",autoCloseTags:true,autoCloseBrackets:true,lineNumbers:true});editorRef.current.on(\"change\",function(instance,changes){var origin=changes.origin;var code=instance.getValue();onCodeChange(code);if(origin!==\"setValue\"){socketRef.current.emit(ACTIONS.CODE_CHANGE,{roomId:roomId,code:code});}});case 2:case\"end\":return _context.stop();}}},_callee);}));return function init(){return _ref2.apply(this,arguments);};}();init();},[onCodeChange,roomId,socketRef]);useEffect(function(){if(socketRef.current){var socket=socketRef.current;socket.on(ACTIONS.CODE_CHANGE,function(_ref3){var code=_ref3.code;if(code!==null){editorRef.current.setValue(code);}});return function(){socket.off(ACTIONS.CODE_CHANGE);};}},[socketRef]);return/*#__PURE__*/_jsx(\"textarea\",{id:\"realtimeEditor\"});};export default Editor;","map":{"version":3,"names":["React","useEffect","codemirror","useRef","ACTIONS","Editor","socketRef","roomId","onCodeChange","editorRef","init","current","fromTextArea","document","getElementById","mode","name","json","theme","autoCloseTags","autoCloseBrackets","lineNumbers","on","instance","changes","origin","code","getValue","emit","CODE_CHANGE","socket","setValue","off"],"sources":["/Users/amankumar/Code-Together/src/components/Editor.jsx"],"sourcesContent":["import React, { useEffect } from 'react';\nimport codemirror from 'codemirror';\nimport 'codemirror/mode/javascript/javascript';\nimport 'codemirror/theme/dracula.css';\nimport 'codemirror/addon/edit/closetag';\nimport 'codemirror/addon/edit/closebrackets';\nimport 'codemirror/lib/codemirror.css'\nimport { useRef } from 'react';\nimport ACTIONS from '../Actions';\n\nconst Editor = ({ socketRef, roomId, onCodeChange }) => {\n  const editorRef = useRef(null);\n\n  useEffect(() => {\n    const init = async () => {\n      editorRef.current = codemirror.fromTextArea(\n        document.getElementById(\"realtimeEditor\"),\n        {\n          mode: { name: \"javascript\", json: true },\n          theme: \"dracula\",\n          autoCloseTags: true,\n          autoCloseBrackets: true,\n          lineNumbers: true,\n        }\n      );\n\n      editorRef.current.on(\"change\", (instance, changes) => {\n        const { origin } = changes;\n        const code = instance.getValue();\n        onCodeChange(code);\n\n        if (origin !== \"setValue\") {\n          socketRef.current.emit(ACTIONS.CODE_CHANGE, {\n            roomId,\n            code,\n          });\n        }\n      });\n    };\n\n    init();\n  }, [onCodeChange, roomId, socketRef]);\n\n  useEffect(() => {\n    if (socketRef.current) {\n      const socket = socketRef.current;\n      socket.on(ACTIONS.CODE_CHANGE, ({ code }) => {\n        if (code !== null) {\n          editorRef.current.setValue(code);\n        }\n      });\n\n      return () => {\n        socket.off(ACTIONS.CODE_CHANGE);\n      };\n    }\n  }, [socketRef]);\n\n  return <textarea id=\"realtimeEditor\"></textarea>;\n};\n\nexport default Editor;"],"mappings":"wPAAA,MAAOA,MAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CACA,MAAOC,WAAP,KAAuB,YAAvB,CACA,MAAO,uCAAP,CACA,MAAO,8BAAP,CACA,MAAO,gCAAP,CACA,MAAO,qCAAP,CACA,MAAO,+BAAP,CACA,OAASC,MAAT,KAAuB,OAAvB,CACA,MAAOC,QAAP,KAAoB,YAApB,C,2CAEA,GAAMC,OAAM,CAAG,QAATA,OAAS,MAAyC,IAAtCC,UAAsC,MAAtCA,SAAsC,CAA3BC,MAA2B,MAA3BA,MAA2B,CAAnBC,YAAmB,MAAnBA,YAAmB,CACtD,GAAMC,UAAS,CAAGN,MAAM,CAAC,IAAD,CAAxB,CAEAF,SAAS,CAAC,UAAM,CACd,GAAMS,KAAI,6FAAG,qIACXD,SAAS,CAACE,OAAV,CAAoBT,UAAU,CAACU,YAAX,CAClBC,QAAQ,CAACC,cAAT,CAAwB,gBAAxB,CADkB,CAElB,CACEC,IAAI,CAAE,CAAEC,IAAI,CAAE,YAAR,CAAsBC,IAAI,CAAE,IAA5B,CADR,CAEEC,KAAK,CAAE,SAFT,CAGEC,aAAa,CAAE,IAHjB,CAIEC,iBAAiB,CAAE,IAJrB,CAKEC,WAAW,CAAE,IALf,CAFkB,CAApB,CAWAZ,SAAS,CAACE,OAAV,CAAkBW,EAAlB,CAAqB,QAArB,CAA+B,SAACC,QAAD,CAAWC,OAAX,CAAuB,CACpD,GAAQC,OAAR,CAAmBD,OAAnB,CAAQC,MAAR,CACA,GAAMC,KAAI,CAAGH,QAAQ,CAACI,QAAT,EAAb,CACAnB,YAAY,CAACkB,IAAD,CAAZ,CAEA,GAAID,MAAM,GAAK,UAAf,CAA2B,CACzBnB,SAAS,CAACK,OAAV,CAAkBiB,IAAlB,CAAuBxB,OAAO,CAACyB,WAA/B,CAA4C,CAC1CtB,MAAM,CAANA,MAD0C,CAE1CmB,IAAI,CAAJA,IAF0C,CAA5C,EAID,CACF,CAXD,EAZW,sDAAH,kBAAJhB,KAAI,2CAAV,CA0BAA,IAAI,GACL,CA5BQ,CA4BN,CAACF,YAAD,CAAeD,MAAf,CAAuBD,SAAvB,CA5BM,CAAT,CA8BAL,SAAS,CAAC,UAAM,CACd,GAAIK,SAAS,CAACK,OAAd,CAAuB,CACrB,GAAMmB,OAAM,CAAGxB,SAAS,CAACK,OAAzB,CACAmB,MAAM,CAACR,EAAP,CAAUlB,OAAO,CAACyB,WAAlB,CAA+B,eAAc,IAAXH,KAAW,OAAXA,IAAW,CAC3C,GAAIA,IAAI,GAAK,IAAb,CAAmB,CACjBjB,SAAS,CAACE,OAAV,CAAkBoB,QAAlB,CAA2BL,IAA3B,EACD,CACF,CAJD,EAMA,MAAO,WAAM,CACXI,MAAM,CAACE,GAAP,CAAW5B,OAAO,CAACyB,WAAnB,EACD,CAFD,CAGD,CACF,CAbQ,CAaN,CAACvB,SAAD,CAbM,CAAT,CAeA,mBAAO,iBAAU,EAAE,CAAC,gBAAb,EAAP,CACD,CAjDD,CAmDA,cAAeD,OAAf"},"metadata":{},"sourceType":"module"}